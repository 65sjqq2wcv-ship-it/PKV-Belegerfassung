<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>PKV Belege</title>
    <meta name="description" content="PKV Belege verwalten und organisieren" />

    <link rel="stylesheet" href="./styles.css" />
    <link rel="manifest" href="./manifest.json" />

    <!-- Icons -->
    <link rel="apple-touch-icon" href="./icons/icon-192x192.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./icons/icon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./icons/icon-16x16.png"
    />

    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="PKV Belege" />
    <meta name="mobile-web-app-capable" content="yes" />

    <!-- Theme Colors -->
    <meta
      name="theme-color"
      content="#FFFFFF"
      media="(prefers-color-scheme: light)"
    />
    <meta
      name="theme-color"
      content="#1E293B"
      media="(prefers-color-scheme: dark)"
    />
  </head>
  <body>
    <div class="app">
      <header>
        <div class="logo">
          <img src="logo.png" alt="PKV Belege" class="logo-img" />
          <div class="header-content">
            <h1>PKV Belege</h1>
            <div class="version-info">v1.15</div>
          </div>
        </div>
        <div class="header-actions">
          <button
            id="backup-icon"
            class="header-icon-btn"
            title="Daten verwalten"
          >
            ğŸ’¾
          </button>
        </div>
      </header>

      <main>
        <!-- Einstellungen Section -->
        <section class="settings-section">
          <h2>âš™ï¸ Einstellungen</h2>
          <div class="settings-compact">
            <div class="setting-row">
              <label for="selbstbeteiligung">Selbstbeteiligung:</label>
              <input
                type="text"
                id="selbstbeteiligung"
                min="0"
                step="0.01"
                placeholder="0,00 â‚¬"
              />
            </div>
            <div class="setting-row">
              <label for="beitragsrueckerstattung"
                >BeitragsrÃ¼ckerstattung:</label
              >
              <input
                type="text"
                id="beitragsrueckerstattung"
                min="0"
                step="0.01"
                placeholder="0,00 â‚¬"
              />
            </div>
            <!-- Jahr Selection in Einstellungen integriert -->
            <div class="setting-row">
              <label for="jahresauswahl">Jahr auswÃ¤hlen:</label>
              <select id="jahresauswahl">
                <option value="2024">2024</option>
                <option value="2025">2025</option>
                <option value="2026">2026</option>
              </select>
            </div>
          </div>
        </section>

        <!-- Ãœbersicht -->
        <section class="overview-section">
          <h2>ğŸ“Š Ãœbersicht <span id="belege-jahr">2024</span></h2>
          <div class="overview-grid">
            <div class="overview-card">
              <h3>Erfasst</h3>
              <div class="amount" id="gesamtbetrag">0,00 â‚¬</div>
            </div>
            <div class="overview-card">
              <h3>bis Einreichung</h3>
              <div class="amount" id="noch-bis-einreichung">0,00 â‚¬</div>
            </div>
            <div class="overview-card lohnt-sich" id="einreichung-status">
              <h3>Status</h3>
              <div class="status-text" id="status-text">Noch nicht lohnend</div>
            </div>
          </div>
        </section>

        <!-- Beleg hinzufÃ¼gen -->
        <section class="add-receipt-section">
          <h2>ğŸ“ Beleg hinzufÃ¼gen / Ã¤ndern</h2>
          <form id="beleg-form" class="beleg-form">
            <div class="form-group">
              <label for="beleg-datum">Datum:</label>
              <input type="date" id="beleg-datum" required />
            </div>
            <div class="form-group">
              <label for="beleg-beschreibung">Beschreibung:</label>
              <input
                type="text"
                id="beleg-beschreibung"
                required
                placeholder="z.B. Arztbesuch..."
              />
            </div>
            <div class="form-group">
              <label for="beleg-betrag">Betrag:</label>
              <input
                type="number"
                id="beleg-betrag"
                step="0.01"
                min="0"
                required
                placeholder="0,00 â‚¬"
              />
            </div>
            <button type="submit" class="btn-primary">Beleg speichern</button>
            <button
              type="button"
              id="beleg-cancel"
              class="btn-secondary"
              style="display: none"
            >
              Abbrechen
            </button>
          </form>
        </section>

        <!-- Belege Liste -->
        <section class="receipts-section">
          <h2>ğŸ“‹ Belege <span id="belege-jahr-2">2024</span></h2>
          <div id="belege-liste" class="belege-liste">
            <!-- Belege werden hier dynamisch eingefÃ¼gt -->
          </div>
        </section>
      </main>
    </div>

    <!-- Modal fÃ¼r Beleg bearbeiten -->
    <div id="edit-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="modal-close">&times;</span>
        <h2>Beleg bearbeiten</h2>
        <form id="edit-form">
          <input type="hidden" id="edit-id" />
          <div class="form-group">
            <label for="edit-datum">Datum:</label>
            <input type="date" id="edit-datum" required />
          </div>
          <div class="form-group">
            <label for="edit-beschreibung">Beschreibung:</label>
            <input type="text" id="edit-beschreibung" required />
          </div>
          <div class="form-group">
            <label for="edit-betrag">Betrag (â‚¬):</label>
            <input
              type="number"
              id="edit-betrag"
              step="0.01"
              min="0"
              required
            />
          </div>
          <div class="modal-buttons">
            <button type="submit" class="btn-primary">Speichern</button>
            <button type="button" id="edit-cancel" class="btn-secondary">
              Abbrechen
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Backup Modal - Scrollbar optimiert -->
    <div id="backup-modal" class="modal">
      <div class="modal-content modal-wide">
        <span class="close" id="backup-modal-close">&times;</span>
        <h2>ğŸ’¾ Daten verwalten</h2>

        <!-- Neuer scrollbarer Wrapper -->
        <div class="backup-content-wrapper">
          <div class="backup-grid">
            <!-- Dein existierender Inhalt bleibt gleich -->
            <!-- Export Section -->
            <div class="backup-section">
              <h3>ğŸ“¤ Daten exportieren</h3>
              <button id="export-json" class="btn-primary backup-btn">
                ğŸ’¾ Backup erstellen
              </button>
              <p class="backup-info-text">
                Erstellt eine vollstÃ¤ndige Sicherung aller Belege und
                Einstellungen.
              </p>
            </div>

            <!-- Import Section -->
            <div class="backup-section">
              <h3>ğŸ“¥ Daten importieren</h3>
              <div class="import-controls">
                <input
                  type="file"
                  id="import-file"
                  accept=".json"
                  style="display: none"
                />
                <button id="select-import-file" class="btn-primary backup-btn">
                  ğŸ“ Backup wiederherstellen
                </button>
                <div id="import-file-info" class="file-info">
                  Keine Datei ausgewÃ¤hlt
                </div>
                <div
                  class="import-options"
                  id="import-options"
                  style="display: none"
                >
                  <h4>Import-Optionen:</h4>
                  <label class="radio-option">
                    <input
                      type="radio"
                      name="import-mode"
                      value="replace"
                      checked
                    />
                    <span>Alle Daten ersetzen</span>
                  </label>
                  <label class="radio-option">
                    <input type="radio" name="import-mode" value="merge" />
                    <span>Daten zusammenfÃ¼hren</span>
                  </label>
                  <label class="radio-option">
                    <input type="radio" name="import-mode" value="add" />
                    <span>Nur neue Belege hinzufÃ¼gen</span>
                  </label>
                  <div class="import-buttons">
                    <button id="confirm-import" class="btn-primary">
                      âœ… Importieren
                    </button>
                    <button id="cancel-import" class="btn-secondary">
                      âŒ Abbrechen
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Backup Info -->
          <div class="backup-info-section">
            <h3>ğŸ’¡ Backup-Tipp</h3>
            <p>
              Erstellen Sie regelmÃ¤ÃŸig ein Backup Ihrer Daten. Die JSON-Datei
              enthÃ¤lt alle Belege und Einstellungen und funktioniert mit
              Hell-/Dunkelmodus.
            </p>
            <div class="last-backup" id="last-backup-info"></div>
          </div>
        </div>
        <!-- Ende des scrollbaren Wrappers -->
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
